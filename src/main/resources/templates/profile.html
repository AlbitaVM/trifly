{{>header}}
<main class="main-profile">
  <div class="page-header">
    <h1 class="form-title" style="text-align: left; margin-bottom: 0;">Perfil</h1>
  </div>
  <div class="profile-grid">
    <!-- Columna izquierda: Perfil del usuario -->
    <div class="profile-sidebar">
      <div class="profile-card">
        <div class="profile-info">
          <div class="profile-photo-wrapper">
            <img src="/user/{{user.id}}/image" alt="Foto de perfil {{user.name}}" class="profile-photo-img">
          </div>
          <div class="profile-text">
            <p class="name">{{user.name}}</p>
            <p class="username">{{user.email}}</p>
          </div>
        </div>
        <a class="btn btn-warning btn-lg btn-block" href="/profile/{{user.id}}/edit">
          <span class="material-symbols-outlined">edit</span>
          Editar Perfil
        </a>

        <div class="profile-actions">
          <button class="btn btn-dark btn-lg btn-block">
            <span class="material-symbols-outlined">logout</span>
            Cerrar Sesión
          </button>
          <button class="btn btn-danger btn-lg btn-block">
            <span class="material-symbols-outlined">delete</span>
            Eliminar Cuenta
          </button>
        </div>
      </div>

      <div class="profile-card">
        <h3>Notas destacadas o favoritas</h3>
        <div class="note">
          <span class="material-symbols-outlined">description</span>
          <span>Mejores restaurantes en Roma</span>
        </div>
        <div class="note">
          <span class="material-symbols-outlined">description</span>
          <span>Tips para trekking en Patagonia</span>
        </div>

        <h3>Valoraciones personales de viajes</h3>
        <div class="note">
          <span class="material-symbols-outlined icon-star">star</span>
          <span>Mi viaje favorito: Kioto, Japón</span>
        </div>
        <div class="note">
          <span class="material-symbols-outlined icon-flag">flag</span>
          <span>Destino pendiente: Islandia</span>
        </div>
      </div>
    </div>

    <!-- Columna derecha: Estadísticas + lista de usuarios -->
    <div class="profile-content">
      <!-- Estadísticas de viaje -->
      <div class="stats-card">
        <h3>Tus Estadísticas de Viaje</h3>
        <div class="stats-grid">
          <div class="stat-box primary">
            <div class="stat-icon-wrapper primary">
              <span class="material-symbols-outlined stat-icon">public</span>
            </div>
            <div>
              <p class="stat-value">12</p>
              <p class="stat-label">Países Visitados</p>
            </div>
          </div>

          <div class="stat-box yellow">
            <div class="stat-icon-wrapper yellow">
              <span class="material-symbols-outlined stat-icon">location_city</span>
            </div>
            <div>
              <p class="stat-value">34</p>
              <p class="stat-label">Ciudades Exploradas</p>
            </div>
          </div>

          <div class="stat-box green">
            <div class="stat-icon-wrapper green">
              <span class="material-symbols-outlined stat-icon">flight_takeoff</span>
            </div>
            <div>
              <p class="stat-value">5</p>
              <p class="stat-label">Próximos Viajes</p>
            </div>
          </div>
        </div>
      </div>

      <!-- Mapa de viajes -->
      <div class="map-card">
        <h3>Tu Mapa de Viajes</h3>
        <div class="map-container">
          <img alt="Mapa del mundo con pines de los lugares visitados"
            src="https://lh3.googleusercontent.com/aida-public/AB6AXuC5hNcnZjLl2XDmWD1dJ_jV-gHKhhXuR3v-C4kg-MzHC9WN5HM_Eilrd_fCV034XyChc85_iyjX2gwIzBCT9v0o4bqT28zacRAPJyKHzA1dIeGJTIeRrgUzJTGZKua81rywP_djO2ZIWQ7bWRnClJNlGwHWEIwFrahh-XtX8WJWbpJ6OSKt6P2eLXCj8vDCI3w68QXd2t_ZTNjWt5s2UVVJsXxLRGgw5NooRYyqp97t6BHAcseYT8LA-nDKmb9RFJAtRttolmMp3lQ" />
        </div>
      </div>

      <!-- Estadísticas tipo Admin Dashboard -->
      <div class="stats-card" style="margin-top: 2rem;">
        <h3>Estadísticas</h3>
        <div class="stats-grid">
          <!-- Usuarios -->
          <div class="stat-box primary">
            <div class="stat-icon-wrapper primary">
              <span class="material-symbols-outlined">group</span>
            </div>
            <div>
              <p class="stat-value">1,250</p>
              <p class="stat-label">Total Usuarios Registrados</p>
              <div class="card-details">
                <div><span>Usuarios nuevos (mes)</span><strong>+128</strong></div>
                <div><span>Activos / Inactivos</span><strong>1,100 / 150</strong></div>
              </div>
            </div>
          </div>

          <!-- Itinerarios -->
          <div class="stat-box yellow">
            <div class="stat-icon-wrapper yellow">
              <span class="material-symbols-outlined">map</span>
            </div>
            <div>
              <p class="stat-value">3,480</p>
              <p class="stat-label">Total Itinerarios</p>
              <div class="card-details">
                <div><span>Promedio por usuario</span><strong>2.8</strong></div>
                <div><span>Crecimiento (mes)</span><strong>+8.5%</strong></div>
              </div>
            </div>
          </div>

          <!-- Presupuestos -->
          <div class="stat-box green">
            <div class="stat-icon-wrapper green">
              <span class="material-symbols-outlined">account_balance_wallet</span>
            </div>
            <div>
              <p class="stat-value">2,958</p>
              <p class="stat-label">Total Presupuestos</p>

            </div>
          </div>
        </div>

        <!-- Gráficos de barras -->
        <div style="margin-top: 2rem;">
          <h4 class="text-center mb-3">Usuarios registrados por mes</h4>
          <canvas id="usersChart" height="120"></canvas>
        </div>

        <div style="margin-top: 2rem;">
          <h4 class="text-center mb-3">Itinerarios creados por mes</h4>
          <canvas id="itinerariesChart" height="120"></canvas>
        </div>
      </div>

      <!-- Lista de usuarios registrados -->
      <div class="stats-card" style="margin-top: 2rem;">
        <h3>Usuarios Registrados</h3>
        {{#users}}
        <div class="list-section">
          <div class="list-item user-item">
            <div class="list-item-icon turquoise">
              <span class="material-symbols-outlined">person</span>
            </div>
            <div class="list-item-content">
              <p>{{name}}</p>
              <p class="list-item-date">{{email}}</p>
            </div>
            <div class="list-item-actions">
              <form method="post" action="/user/{{id}}/delete"   style="display: inline-flex; margin: 0; padding: 0;">
                  <input type="hidden" name="_csrf" value="{{token}}">
                  <button type="submit" class="btn-icon-delete" title="Eliminar">
                    <span class="material-symbols-outlined">delete</span>
                  </button>
              </form>
            </div>
          </div>
          {{/users}}
        </div>
        <div class="row mt-4">
          <div class="col-12">
            <nav aria-label="Paginación de itinerarios">
              <ul class="pagination justify-content-center">

                <!-- Botón Anterior -->
                {{#hasPrevious}}
                <li class="page-item">
                  <a class="page-link" href="/notes?page={{previousPage}}">&laquo;</a>
                </li>
                {{/hasPrevious}}

                <!-- Números de página (necesitarás pasar una lista desde el controlador) -->
                {{#pageNumbers}}
                <li class="page-item {{#active}}active{{/active}}">
                  <a class="page-link" href="/notes?page={{number}}">{{display}}</a>
                </li>
                {{/pageNumbers}}

                <!-- Botón Siguiente -->
                {{#hasNext}}
                <li class="page-item">
                  <a class="page-link" href="/notes?page={{nextPage}}">&raquo;</a>
                </li>
                {{/hasNext}}
              </ul>
            </nav>
          </div>
        </div>
      </div>

    </div>
  </div>
</main>

<!-- Chart.js -->
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
  const meses = ['Enero', 'Febrero', 'Marzo', 'Abril', 'Mayo', 'Junio'];
  const usuarios = [5, 8, 12, 7, 10, 15];
  const itinerarios = [3, 6, 9, 4, 7, 11];

  new Chart(document.getElementById('usersChart'), {
    type: 'bar',
    data: {
      labels: meses,
      datasets: [{
        label: 'Usuarios registrados',
        data: usuarios,
        backgroundColor: 'rgba(54, 162, 235, 0.6)',
        borderColor: 'rgba(54, 162, 235, 1)',
        borderWidth: 1
      }]
    },
    options: { responsive: true, scales: { y: { beginAtZero: true } } }
  });

  new Chart(document.getElementById('itinerariesChart'), {
    type: 'bar',
    data: {
      labels: meses,
      datasets: [{
        label: 'Itinerarios creados',
        data: itinerarios,
        backgroundColor: 'rgba(222, 170, 12, .5)',
        borderColor: 'rgba(245, 186, 7, 0.5)',
        borderWidth: 1
      }]
    },
    options: { responsive: true, scales: { y: { beginAtZero: true } } }
  });
</script>
{{>footer}}